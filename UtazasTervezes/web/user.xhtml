<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <style>
            html, body {
              height: 100%;
              width : 100%;
              margin: 0;
              padding: 0;
            }
        </style>

        <link rel="stylesheet" type="text/css" href="user.css"/> 
        <title>#{userBean.getNev()}</title>
        <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?libraries=places&amp;sensor=false&amp;key=AIzaSyA4hjb09i3NOLmedn71DkLoBFMjo8krFb4"></script>
        
        <script>
            var directionsDisplay;
            var directionsService = new google.maps.DirectionsService();
            var map;
            var distance;
            
            function initialize() {
                directionsDisplay = new google.maps.DirectionsRenderer();
                var veszprem = new google.maps.LatLng(47.1257777,17.8372087);
                var mapOptions = {
                zoom:7,
                mapTypeId: google.maps.MapTypeId.ROADMAP,
                center: veszprem
            }
            map = new google.maps.Map(document.getElementById("map-canvas"), mapOptions);
            directionsDisplay.setMap(map);

            }

            function calcRoute() {
                var start = document.getElementById("fooldal:start").value;
                var end = document.getElementById("fooldal:end").value;

                var request = {
                    origin:start,
                    destination:end,
                    travelMode: google.maps.TravelMode.DRIVING
                };
                directionsService.route(request, function(response, status) {
                    if (status == google.maps.DirectionsStatus.OK) {
                    directionsDisplay.setDirections(response);
                    var route = response.routes[0]

                    //  alert(route.legs[1].duration.text);
                    var summaryPanel = document.getElementById('directions_panel');
                    summaryPanel.innerHTML = '';
                    var summaryPanel2 = document.getElementById('distance');
                    summaryPanel2.innerHTML ='';
                    // For each route, display summary information.
                    for (var i = 0; i &lt; route.legs.length; i++) {
                        var routeSegment = i + 1;
                        distance=route.legs[i].distance.text;
                        summaryPanel.innerHTML += '<b>Route Segment: ' + routeSegment + '</b><br/>';
                        summaryPanel.innerHTML += route.legs[i].start_address + ' to ';
                        summaryPanel.innerHTML += route.legs[i].end_address + '<br/>';
                        summaryPanel.innerHTML += route.legs[i].duration.text + '<br/>';
                        summaryPanel2.innerHTML += route.legs[i].distance.text;
                        #{userBean.setDistance(distance)};
                        swap();
                    }

                    }
                });
            }
            google.maps.event.addDomListener(window, 'load', initialize);
           
            function swap(){
                var stuff=distance.split(",")[0];
                var stuff=stuff.split(" ")[0];
                document.getElementById('fooldal:distance2').value=stuff;
                document.getElementById('fooldal:wizard:confirm:confirmation:distance3').value=stuff;
                window.alert(document.getElementById('distance3').value);
                window.alert("LOL");
            }
           
            </script>
        
            
        
    </h:head>

    <h:body>
        <div id="baloldal">
            <h2 id="elozo">Előző utazások:</h2>
        <h:form >
            <p:button value="ShowPDFS" outcome="showPDFS"/><br/>
        </h:form>
        </div>
            
            
            <p:dialog id="gmapDialog" widgetVar="dlg" width="1000" height="563" modal="true">
                <div id="map-canvas"></div>
            </p:dialog>
                  
        <h:form id="fooldal">
            <img src="pannon.PNG" alt="The ENIAC" />          
            <h2>#{userBean.getNev()}</h2>
            <h2>#{sharedBean.neptun}</h2><br/>
            <p id="details">Az utazásiterv elfogadása két fázisból áll. Első lépésben el kell készíteni az útiköltség tervet, amit a dékánnak (vagy más erre hivatott szervezetnek) el kell bírálni. Ha a tervet elfogadták, akkor folytatni lehet egy utazásiterv kitöltésével, amit ha elfogadnak, akkor az utazás finanszírozva lesz.</p>
    
            <p:commandButton value="Utazási Terv (folytatás)" ajax="false" action="#{userBean.utazasiTerv}" style="margin:20px;"/>          
            <p:commandButton value="Személygépkocsi Kalkuláció" ajax="false" action="#{userBean.szgkKalk}" style="margin:20px;"/>          
       
            
            <div id="directions_panel" style="margin:20px;"></div>
            <p id="distance" value="#{userBean.distance}" style="margin:20px;"></p>
            
            <p:inputTextarea id="distance2" value="#{userBean.distance}"> </p:inputTextarea>

            <br/>
        </h:form>
        <br/>
            <div id="googletravel">
                <strong>Mode of Travel: </strong>
                <select id="mode" onChange="calcRoute();">
                <option value="DRIVING">Autóval</option>
                <option value="WALKING">Séta</option>
                <option value="BICYCLING">Kerékpárral</option>
                <option value="TRANSIT">Tömegközlekedéssel</option>
                </select>
         </div>
    </h:body>
    
</html>

