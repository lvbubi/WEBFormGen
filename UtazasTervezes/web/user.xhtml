<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <style>
            html, body {
              height: 100%;
              width : 100%;
              margin: 0;
              padding: 0;
            }
        </style>

        <link rel="stylesheet" type="text/css" href="user.css"/> 
        <title>#{userBean.getNev()}</title>
        <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?libraries=places&amp;sensor=false&amp;key=AIzaSyA4hjb09i3NOLmedn71DkLoBFMjo8krFb4"></script>
        
        <script>
            var directionsDisplay;
            var directionsService = new google.maps.DirectionsService();
            var map;
            var distance;
            
            function initialize() {
                directionsDisplay = new google.maps.DirectionsRenderer();
                var veszprem = new google.maps.LatLng(47.1257777,17.8372087);
                var mapOptions = {
                zoom:7,
                mapTypeId: google.maps.MapTypeId.ROADMAP,
                center: veszprem
            }
            map = new google.maps.Map(document.getElementById("map-canvas"), mapOptions);
            directionsDisplay.setMap(map);

            }

            function calcRoute() {
                var start = document.getElementById("fooldal:start").value;
                var end = document.getElementById("fooldal:end").value;

                var request = {
                    origin:start,
                    destination:end,
                    travelMode: google.maps.TravelMode.DRIVING
                };
                directionsService.route(request, function(response, status) {
                    if (status == google.maps.DirectionsStatus.OK) {
                    directionsDisplay.setDirections(response);
                    var route = response.routes[0]

                    //  alert(route.legs[1].duration.text);
                    var summaryPanel = document.getElementById('directions_panel');
                    summaryPanel.innerHTML = '';
                    var summaryPanel2 = document.getElementById('distance');
                    summaryPanel2.innerHTML ='';
                    // For each route, display summary information.
                    for (var i = 0; i &lt; route.legs.length; i++) {
                        var routeSegment = i + 1;
                        distance=route.legs[i].distance.text;
                        summaryPanel.innerHTML += '<b>Route Segment: ' + routeSegment + '</b><br/>';
                        summaryPanel.innerHTML += route.legs[i].start_address + ' to ';
                        summaryPanel.innerHTML += route.legs[i].end_address + '<br/>';
                        summaryPanel.innerHTML += route.legs[i].duration.text + '<br/>';
                        summaryPanel2.innerHTML += route.legs[i].distance.text;
                        #{userBean.setDistance(distance)};
                        swap();
                    }

                    }
                });
            }
            google.maps.event.addDomListener(window, 'load', initialize);
           
            function swap(){
                var stuff=distance.split(",")[0];
                var stuff=stuff.split(" ")[0];
                document.getElementById('fooldal:distance2').value=stuff;
                document.getElementById('fooldal:wizard:confirm:confirmation:distance3').value=stuff;
                window.alert(document.getElementById('distance3').value);
                window.alert("LOL");
            }
           
            </script>
        <script>
            function utikoltseg(){
                document.getElementById('fooldal:wizard').style.display='block';
                document.getElementById('fooldal:uj').style.display='none';
                document.getElementById('fooldal:folytat').style.display='none';
            }
            function utazasiterv(){
                document.getElementById('fooldal:utazasterv').style.display='block';
                document.getElementById('fooldal:uj').style.display='none';
                document.getElementById('fooldal:folytat').style.display='none';
            }
        </script>
            
        
    </h:head>

    <h:body>
        <div id="baloldal">
            <h2 id="elozo">Előző utazások:</h2>
        <h:form >
            <p:button value="ShowPDFS" outcome="showPDFS"/><br/>
        </h:form>
        </div>
            
            
            <p:dialog id="gmapDialog" widgetVar="dlg" width="1000" height="563" modal="true">
                <div id="map-canvas"></div>
            </p:dialog>
                  
        <h:form id="fooldal">
            <img src="pannon.PNG" alt="The ENIAC" />          
            <h2>#{userBean.getNev()}</h2>
            <h2>#{sharedBean.neptun}</h2><br/>
            <p>Az utazásiterv elfogadása két fázisból áll. Első lépésben el kell készíteni az útiköltség tervet, amit a dékánnak (vagy más erre hivatott szervezetnek) el kell bírálniuk. Ha a tervet elfogadták, akkor folytatni lehet egy utazásiterv kitöltésével, amit ha elfogadnak, akkor az utazás finanszírozva lesz.</p>
            <p:commandButton type="button" value="Új útiköltségterv készítése" onclick="utikoltseg();" id="uj" styleClass="styleuj" ></p:commandButton> 
            <p:commandButton id="folytat" type="button" value="Folytatás utazásiterv kitöltésével" onclick="utazasiterv();" styleClass="stylefolytat"/>  
            <p:wizard flowListener="#{userBean.onFlowProcess}" id="wizard" styleClass="wizza">
                <p:tab id="personal" title="Personal" >
                    <p:panel header="Útvonal">
                        <p:messages />
                        <h:panelGrid columns="2" columnClasses="label, value">
                            <h:outputText value="Honnan *" />
                            <p:inputText value="#{userBean.honnan}" id="start" required="true"/>
                            
                            <h:outputText value="Hová *" />
                            <p:inputText value="#{userBean.hova}" id="end" required="true"/>
                            
                            <h:outputText value="Autó: *" />
                            <h:selectOneMenu value="#{userBean.rendszam}" required="true" id="kocsiproba" >
                                <f:selectItem itemLabel="Select One" itemValue="" />
                                <f:selectItems value="#{userBean.rendszamok}" />
                            </h:selectOneMenu>
                            
                            <p:commandButton type="button" value="Calculate Distance NINCS ELLENŐRIZVE HOGY MEG LETT NYOMVA" onclick="calcRoute();"/> 
                            <p:commandButton id="btn" type="button" icon="ui-icon-pin-s" value="Show Map" onclick="PF('dlg').show();" />  
                        </h:panelGrid>
                    </p:panel>
                </p:tab>
                <p:tab id="address" title="Utazás">
                    <p:panel header="Egyeb">
                        <p:messages />
                        <h:panelGrid columns="2" columnClasses="label, value">
                            <p:outputLabel for="advanced" value="Valuta:" />
                            <p:selectOneListbox id="advanced" value="#{userBean.currency}" filter="true" filterMatchMode="contains">
                                <f:selectItems value="#{userBean.getValutaTypesKeret()}" />
                            </p:selectOneListbox>
                            
                            <h:outputText value="Autópálya költség:" />
                            <h:inputText  value="#{userBean.autopalyFT}" />
                            
                            <h:outputText value="Autópálya költség deviza:" />
                            <h:inputText  value="#{userBean.autopalyaDevizva}" />
                            
                            <h:outputText value="Parkírozás Deviza:" />
                            <h:inputText  value="#{userBean.parkirozasDeviza}" />
                        </h:panelGrid>
                    </p:panel>
                </p:tab>
                
                
                <p:tab id="confirm" title="Jóváhagyás">
                    <p:panel header="Jóváhagyás">
                        <h:panelGrid id="confirmation" columns="2" columnClasses="grid,grid">
                            <h:panelGrid columns="2" columnClasses="label, value">
                                <h:outputText value="Honnan: " />
                                <h:outputText value="#{userBean.honnan}" styleClass="outputLabel"/>
                            </h:panelGrid>

                            <h:panelGrid columns="2" columnClasses="label, value">
                                <h:outputText value="Hova: " />
                                <h:outputText value="#{userBean.hova}" styleClass="outputLabel"/>
                            </h:panelGrid>
                            
                            <h:panelGrid columns="2" columnClasses="label, value">
                                <h:outputText value="Név: " />
                                <h:outputText value="#{userBean.getNev()}" styleClass="outputLabel"/>
                            </h:panelGrid>
                            
                            <h:panelGrid columns="2" columnClasses="label, value">
                                <h:outputText value="Autó: " />
                                <h:outputText value="#{userBean.rendszam}" styleClass="outputLabel"/>
                            </h:panelGrid>
                        </h:panelGrid>
                    </p:panel>
                </p:tab>
            </p:wizard>
            <p:wizard id="utazasterv" styleClass="utazas">
                <p:tab id="utaz" title="Personal" >
                    <p:panel header="Út célja">
                        <p:messages />
                        <h:panelGrid columns="2" columnClasses="label, value">
                            <h:outputText value="Konferencián való részvétel esetén a bejelentett előadás/poszter* címe: *" />
                            <p:inputTextarea value="#{userBean.eloadas_postercim}" counter="display" maxlength="100" counterTemplate="{0} characters remaining." autoResize="true" required="true"  />
                            <h:outputText id="display" />
                            
                            <h:outputText value="Az utazás célja: " />
                            <p:inputTextarea value="#{userBean.utazas_celja}" counter="display" maxlength="100" counterTemplate="{0} characters remaining." autoResize="true" required="true"  />
                            
                            <h:outputText value="Tanulmányút esetén milyen program keretében kerül sor az utazásra*:" />
                            <p:selectOneMenu label="Keret" value="#{userBean.egyebkeret}" effect="fold" editable="true" required="true">
                                <f:selectItem itemDisabled="TRUE" itemLabel="Select One" itemValue=""  />
                                <f:selectItems value="#{userBean.utazasiKeret}" />
                            </p:selectOneMenu>
                        </h:panelGrid>
                    </p:panel>
                </p:tab>
            </p:wizard>
            <div id="directions_panel" style="margin:20px;"></div>
            <p id="distance" value="#{userBean.distance}" style="margin:20px;"></p>
            
            <p:inputTextarea id="distance2" value="#{userBean.distance}"> </p:inputTextarea>

            <br/>

            <p:commandButton value="Kérelem elküldése" ajax="false" actionListener="#{userBean.genPDF()}" style="margin:20px;"/>          
        </h:form>
        <br/>
            <div id="googletravel">
                <strong>Mode of Travel: </strong>
                <select id="mode" onChange="calcRoute();">
                <option value="DRIVING">Autóval</option>
                <option value="WALKING">Séta</option>
                <option value="BICYCLING">Kerékpárral</option>
                <option value="TRANSIT">Tömegközlekedéssel</option>
                </select>
         </div>
    </h:body>
    
</html>

